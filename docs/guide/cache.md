# 缓存管理

CogniaLauncher 使用 SQLite + JSON 双后端缓存系统，管理下载缓存和元数据缓存。

---

## 功能概述

### 缓存类型

| 类型 | 存储方式 | 用途 |
|------|----------|------|
| 下载缓存 | 文件系统 | 已下载的包和二进制文件 |
| 元数据缓存 | SQLite | 包信息、版本列表、搜索结果 |
| 版本缓存 | JSON | 前端版本检测结果缓存 |

### 缓存统计

在 **缓存** 页面可查看：

- 缓存总大小
- 条目数量
- 命中率
- 最后清理时间

---

## 缓存操作

### 清理缓存

按缓存类型清理：

- **全部清理** — 删除所有缓存
- **按类型清理** — 仅清理下载缓存或元数据缓存
- **按 Provider 清理** — 清理特定 Provider 的缓存
- **按时间清理** — 清理超过指定天数的缓存

### 验证缓存

检查缓存完整性：

- 校验文件哈希
- 检测损坏的条目
- 报告不一致项

### 修复缓存

自动修复发现的问题：

- 删除损坏条目
- 重建索引
- 清理孤立文件

---

## 缓存设置

| 设置 | 描述 | 默认值 |
|------|------|--------|
| 最大缓存大小 | 缓存占用上限 | 无限制 |
| 最大缓存天数 | 缓存过期天数 | 无限制 |
| 自动清理 | 超过阈值自动清理 | 关闭 |
| 清理阈值 | 触发自动清理的占用百分比 | 80% |
| 监控间隔 | 缓存状态检查间隔（秒） | 300 |
| 外部缓存监控 | 监控外部包管理器的缓存 | 关闭 |

---

## 缓存迁移

支持将缓存数据在不同存储后端之间迁移（SQLite ↔ JSON）。

通过缓存页面的 **迁移** 按钮操作。

---

## 相关命令

| 命令 | 描述 |
|------|------|
| `cache_info` | 获取缓存统计 |
| `cache_clean` | 清理缓存 |
| `cache_verify` | 验证缓存完整性 |
| `cache_repair` | 修复缓存 |
| `get_cache_settings` | 获取缓存设置 |
| `set_cache_settings` | 更新缓存设置 |
